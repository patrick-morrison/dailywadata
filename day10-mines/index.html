<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Western Australia Abandoned Mines</title>
    <meta name="description" content="Interactive map of Western Australia abandoned mines">

    <!-- External Dependencies -->
    <script src="https://unpkg.com/maplibre-gl@4.7.1/dist/maplibre-gl.js"></script>
    <link href="https://unpkg.com/maplibre-gl@4.7.1/dist/maplibre-gl.css" rel="stylesheet">
    <script src="https://unpkg.com/deck.gl@9.0.16/dist.min.js"></script>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&family=JetBrains+Mono:wght@300;400&display=swap"
        rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="style.css">
    <script async defer data-website-id="1c211c11-4d9f-4266-bdc8-c0ec05d7a8cf"
        src="https://umami.padmorrison.com/umami.js"></script>
</head>

<body>
    <!-- Loading State -->
    <div id="loading" class="loading-overlay">
        <div class="loading-spinner"></div>
        <div class="loading-text" id="loading-text">Loading abandoned mines data...</div>
    </div>

    <!-- Navigation -->
    <a href="../index.html" class="back-link">← Back to calendar</a>

    <!-- Map Container -->
    <div id="map"></div>

    <!-- Header -->
    <div class="overlay header">
        <div class="title-card">
            <h1>Western Australia Abandoned Mines</h1>
            <div class="subtitle">Historical Mining Sites</div>
            <div class="title-meta"><span class="attribution">Aren Leishman 2026</span><a href="../sources.html"
                    class="methods-link">Show methods notes →</a></div>
        </div>
    </div>

    <!-- Location Button -->
    <button class="location-btn" id="location-btn" title="Show my location">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="3" />
            <path d="M12 2v4M12 18v4M2 12h4M18 12h4" />
        </svg>
    </button>

    <!-- Filter FAB Button (Mobile) -->
    <button class="filter-fab" id="filter-fab" title="Toggle filters">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3" />
        </svg>
        <span class="filter-badge" id="filter-badge">0</span>
    </button>

    <!-- Legend -->
    <div class="overlay legend" id="legend-drawer" data-state="minimized">
        <div class="legend-card">
            <!-- Drawer Handle (Mobile) -->
            <div class="drawer-handle" id="drawer-handle">
                <div class="drawer-handle-bar"></div>
                <div class="drawer-header">
                    <span class="active-count">No filters active</span>
                    <button class="drawer-toggle-btn" id="drawer-toggle" aria-label="Toggle filters">
                        <svg width="20" height="20" class="chevron-icon">
                            <polyline points="6 9 12 15 18 9" stroke="currentColor" stroke-width="2" fill="none" />
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Drawer Content -->
            <div class="drawer-content">
                <div class="cursor-info" id="cursor-info">
                    <div class="cursor-info-row">
                        <span class="cursor-info-label">At cursor:</span>
                        <span class="cursor-info-value" id="cursor-info-value">--</span>
                    </div>
                    <div class="cursor-coords" id="cursor-coords">--</div>
                </div>
                <div class="legend-stats" id="legend-stats">
                    <span class="stats-label">Visible sites:</span>
                    <span class="stats-value" id="mine-count">--</span>
                </div>

                <!-- Display Mode Selector -->
                <div class="display-mode-selector">
                    <label>Color by:</label>
                    <select id="display-mode">
                        <option value="feature-type" selected>Feature Type</option>
                        <option value="condition">Condition</option>
                        <option value="base-condition">Base Condition</option>
                        <option value="edge-stability">Edge Stability</option>
                        <option value="commodity">Commodity</option>
                    </select>
                </div>

                <!-- Filter Tabs -->
                <div class="filter-tabs">
                    <button class="filter-tab active" data-tab="feature-type">Feature Type</button>
                    <button class="filter-tab" data-tab="condition">Condition</button>
                    <button class="filter-tab" data-tab="base-condition">Base Condition</button>
                    <button class="filter-tab" data-tab="edge-stability">Edge Stability</button>
                    <button class="filter-tab" data-tab="commodity">Commodities</button>
                    <button class="filter-tab" data-tab="visibility">Visibility</button>
                    <button class="filter-tab" data-tab="excavation">Excavation</button>
                </div>

                <!-- Filter Panels (populated dynamically) -->
                <div class="filter-panels">
                    <div class="filter-panel active" data-panel="feature-type">
                        <!-- Filter items will be added dynamically -->
                    </div>
                    <div class="filter-panel" data-panel="condition">
                    </div>
                    <div class="filter-panel" data-panel="base-condition">
                    </div>
                    <div class="filter-panel" data-panel="edge-stability">
                    </div>
                    <div class="filter-panel" data-panel="commodity">
                    </div>
                    <div class="filter-panel" data-panel="visibility">
                    </div>
                    <div class="filter-panel" data-panel="excavation">
                    </div>
                </div>

                <!-- Active Filter Summary -->
                <div class="active-filters-summary">
                    <button class="clear-filters-btn">Clear All</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Application Script -->
    <script src="main.js"></script>
</body>

</html>
